<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API Integration | PayFast Documentation</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" type="image/png" sizes="32x32" href="/VuePress-Payfast-Docs/images/PayFast Coins.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/VuePress-Payfast-Docs/images/PayFast Coins.png">
    <meta name="description" content="aa">
    <link rel="preload" href="/VuePress-Payfast-Docs/assets/css/0.styles.f0968032.css" as="style"><link rel="preload" href="/VuePress-Payfast-Docs/assets/js/app.40217ecf.js" as="script"><link rel="preload" href="/VuePress-Payfast-Docs/assets/js/1.a320b6d4.js" as="script"><link rel="preload" href="/VuePress-Payfast-Docs/assets/js/11.8ec258f5.js" as="script"><link rel="prefetch" href="/VuePress-Payfast-Docs/assets/js/10.f6eec8ea.js"><link rel="prefetch" href="/VuePress-Payfast-Docs/assets/js/12.d7f37100.js"><link rel="prefetch" href="/VuePress-Payfast-Docs/assets/js/13.47040faf.js"><link rel="prefetch" href="/VuePress-Payfast-Docs/assets/js/14.e1fabdee.js"><link rel="prefetch" href="/VuePress-Payfast-Docs/assets/js/15.bea52dd8.js"><link rel="prefetch" href="/VuePress-Payfast-Docs/assets/js/16.c380c53c.js"><link rel="prefetch" href="/VuePress-Payfast-Docs/assets/js/3.6611cd3c.js"><link rel="prefetch" href="/VuePress-Payfast-Docs/assets/js/4.699ac3f8.js"><link rel="prefetch" href="/VuePress-Payfast-Docs/assets/js/5.eaf71ce5.js"><link rel="prefetch" href="/VuePress-Payfast-Docs/assets/js/6.418dcf22.js"><link rel="prefetch" href="/VuePress-Payfast-Docs/assets/js/7.cbee643b.js"><link rel="prefetch" href="/VuePress-Payfast-Docs/assets/js/8.06fd6c97.js"><link rel="prefetch" href="/VuePress-Payfast-Docs/assets/js/9.33307e69.js">
    <link rel="stylesheet" href="/VuePress-Payfast-Docs/assets/css/0.styles.f0968032.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/VuePress-Payfast-Docs/" class="home-link router-link-active"><img src="/VuePress-Payfast-Docs/images/PayFast Logo Colour.svg" alt="PayFast Documentation" class="logo"> <span class="site-name can-hide">PayFast Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/VuePress-Payfast-Docs/blog/" class="nav-link">
  Blogs
</a></div><div class="nav-item"><a href="/VuePress-Payfast-Docs/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="https://sandbox.payfast.co.za" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Sandbox
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.payfast.co.za" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PayFast Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/VuePress-Payfast-Docs/blog/" class="nav-link">
  Blogs
</a></div><div class="nav-item"><a href="/VuePress-Payfast-Docs/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="https://sandbox.payfast.co.za" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Sandbox
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.payfast.co.za" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PayFast Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/VuePress-Payfast-Docs/guide/" aria-current="page" class="sidebar-link">Web Integration</a></li><li><a href="/VuePress-Payfast-Docs/guide/apiIntegration.html" aria-current="page" class="active sidebar-link">API Integration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/VuePress-Payfast-Docs/guide/apiIntegration.html#how-it-works" class="sidebar-link">How it Works</a></li><li class="sidebar-sub-header"><a href="/VuePress-Payfast-Docs/guide/apiIntegration.html#recurring-billing" class="sidebar-link">Recurring Billing</a></li><li class="sidebar-sub-header"><a href="/VuePress-Payfast-Docs/guide/apiIntegration.html#subscription-payments-api-endpoints" class="sidebar-link">Subscription Payments API Endpoints</a></li><li class="sidebar-sub-header"><a href="/VuePress-Payfast-Docs/guide/apiIntegration.html#ad-hoc-payments-api-endpoints" class="sidebar-link">Ad Hoc Payments API Endpoints</a></li><li class="sidebar-sub-header"><a href="/VuePress-Payfast-Docs/guide/apiIntegration.html#payfast-account" class="sidebar-link">PayFast Account</a></li><li class="sidebar-sub-header"><a href="/VuePress-Payfast-Docs/guide/apiIntegration.html#credit-card-transaction-query" class="sidebar-link">Credit Card Transaction Query</a></li><li class="sidebar-sub-header"><a href="/VuePress-Payfast-Docs/guide/apiIntegration.html#api-validation" class="sidebar-link">API Validation</a></li></ul></li><li><a href="/VuePress-Payfast-Docs/guide/splitPayments.html" class="sidebar-link">Split payments</a></li><li><a href="/VuePress-Payfast-Docs/guide/sysInfo.html" class="sidebar-link">System Information</a></li><li><a href="/VuePress-Payfast-Docs/guide/testsAndTools.html" class="sidebar-link">Testing And Tools</a></li><li><a href="/VuePress-Payfast-Docs/guide/pci.html" class="sidebar-link">PCI Compliance</a></li><li><a href="/VuePress-Payfast-Docs/guide/faq.html" class="sidebar-link">FAQs</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="api-integration"><a href="#api-integration" class="header-anchor">#</a> API Integration</h1> <h3 id="getting-started"><a href="#getting-started" class="header-anchor">#</a> Getting Started</h3> <p>PayFast is in the process of rolling out a fully-fledged RESTful API. The first endpoints available will be for the management of subscriptions, with further functionality being released in the near future.</p> <h2 id="how-it-works"><a href="#how-it-works" class="header-anchor">#</a> How it Works</h2> <p>All API communications with PayFast take the form of standard HTTP requests. These requests are made against a set of endpoints, depending on the action required. Variables may be sent via both the headers and body of each request as specified. The minimum set of variables required to connect to PayFast’s API services are detailed below.</p> <p>API services follow RESTful principles, and thus rely on HTTP verbs to describe the action being requested:</p> <ul><li>HTTP GET is used retrieve a resource.</li> <li>HTTP PUT is used where an action is required on a resource.</li> <li>HTTP POST is used where a resource needs to be created.</li> <li>HTTP PATCH is used to update all / subset of a resource.</li></ul> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Using the wrong verb for any endpoint will result in a Bad Request (400) error</p></div> <h3 id="minimum-requirements"><a href="#minimum-requirements" class="header-anchor">#</a> Minimum Requirements</h3> <p>At a minimum, the following must be provided to gain access to the API ecosystem:</p> <ol><li>A valid and an API enabled PayFast merchant account</li> <li>A passphrase as set on the merchant account settings page</li> <li>PayFast merchant ID</li> <li>The version of the API you want to interact with</li> <li>A valid merchant signature</li> <li>A timestamp included in the request</li></ol> <h3 id="input-formats-and-content-types"><a href="#input-formats-and-content-types" class="header-anchor">#</a> Input Formats and Content Types</h3> <p>Sending data to the API may be done in one of two ways:</p> <ul><li>application/x-www-form-urlencoded Essentially one big query string where all name / value pairs are separated by the ‘&amp;’ symbol, with an equal (=) symbol between name and value. This is similar to submitting the traditional HTML FORM via POST (eg. frequency=3&amp;cycles=12…).</li> <li>application/json Fields should be passed in as a single-level JSON representation. Example to the right in the Json tab.</li></ul> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;frequency&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cycles&quot;</span><span class="token operator">:</span><span class="token number">12</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="api-signature-generation"><a href="#api-signature-generation" class="header-anchor">#</a> API Signature Generation</h3> <p>The security signature of the transmitted data takes the form of an <b>MD5 hash of the alphabetised submitted variables, header and body variables</b>, as well as the passphrase. The string from which the hash is created is the concatenation of the name value pairs of all the <b>non-blank variables</b> with <b>‘&amp;’</b> used as a separator. Each value should also be <b>urlencoded</b> (eg. “merchant-id=10000100&amp;passphrase=passphrase&amp;..&amp;version=v1”).</p> <p>The generated MD5 signature must be passed in the header of the request and this hash will be regenerated by the API and compared to ensure the integrity of the data transfer.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">// $pfData will contain all of the values to be sent to the API,</span>
<span class="token comment">// As well as in both the headers and the body.</span>
<span class="token variable">$pfData</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'$fieldsToTransmit'</span><span class="token punctuation">;</span>

<span class="token comment">// Construct variables </span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span> <span class="token variable">$pfData</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$val</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span> <span class="token variable">$val</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$passPhrase</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$pfData</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'passphrase'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$passPhrase</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Sort the array by key, alphabetically</span>
<span class="token function">ksort</span><span class="token punctuation">(</span><span class="token variable">$pfData</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Normalise the array into a parameter string</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span> <span class="token variable">$pfData</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$val</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$key</span> <span class="token operator">!=</span> <span class="token single-quoted-string string">'signature'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$pfParamString</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$key</span> <span class="token punctuation">.</span><span class="token single-quoted-string string">'='</span><span class="token punctuation">.</span> <span class="token function">urlencode</span><span class="token punctuation">(</span> <span class="token variable">$val</span> <span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token single-quoted-string string">'&amp;amp;'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Remove the last '&amp;amp;' from the parameter string</span>
<span class="token variable">$pfParamString</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span> <span class="token variable">$pfParamString</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$signature</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span> <span class="token variable">$pfParamString</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><h4 id="difference-between-checkout-page-signature-generation-and-api-signature-generation"><a href="#difference-between-checkout-page-signature-generation-and-api-signature-generation" class="header-anchor">#</a> Difference between Checkout Page Signature generation and API Signature Generation</h4> <table><thead><tr><th></th> <th>Checkout Page Signature</th> <th>API Signature</th></tr></thead> <tbody><tr><td>Merchant ID variable name</td> <td>merchant_id</td> <td>merchant-id</td></tr> <tr><td>Order of the string variables (before hashing)</td> <td>The variables need to be ordered correctly, as per the checkout page documentation</td> <td>The data is ksorted, in other words, the variable are ordered alphabetically</td></tr> <tr><td>Amount</td> <td>The amount which the buyer must pay, in RANDS (ZAR)</td> <td>The amount which the buyer must pay, in CENTS (ZAR)</td></tr></tbody></table> <h3 id="merchant-passphrase"><a href="#merchant-passphrase" class="header-anchor">#</a> Merchant Passphrase</h3> <p>The signature described previously utilises a passphrase that is chosen by the merchant and is linked to their account. Every request sent by the merchant will have a signature that is salted with their passphrase. The passphrase is considered a secret between the merchant and PayFast and should never be sent or given out.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>A passphrase must be set by the merchant before any API interaction is allowed</p></div> <p>The merchant may set their own passphrase by:</p> <ol><li>Login to PayFast using their merchant credentials.</li> <li>Clicking on ‘Settings’, and then ‘Edit’ under the ‘Security Pass Phrase’ section.</li> <li>Inputting the desired passphrase, and clicking ‘Update’</li></ol> <h3 id="request-timestamp"><a href="#request-timestamp" class="header-anchor">#</a> Request Timestamp</h3> <p>Each request to the API must contain an ISO-8601 formatted timestamp. This field must be present in each request body along with the signature. Failure to include this field will result in an error. The timestamp field must be formatted according to ISO-8601 standards, and be in the following format:</p> <p><span style="background-color:#e6e6ff;">YYYY-MM-DDTHH:MM[(+-)HH:MM] (e.g. 2016-04-01T12:00:01+02:00)</span></p> <p>The time zone offset group ((+-)HH:MM) is optional. If not included, the default will be assumed to be GMT +2.</p> <h3 id="ip-whitelisting"><a href="#ip-whitelisting" class="header-anchor">#</a> IP Whitelisting</h3> <p>Each request to the API may be controlled by an IP address whitelist. If set, the IP address of the server completing the API call must be in the given list, else the action will not be processed. The whitelist can be set on the merchant’s settings page and is an optional security setting.</p> <h3 id="variable-format"><a href="#variable-format" class="header-anchor">#</a> Variable format</h3> <p>The below table describes the formats of the variables used when integrating with PayFast.</p> <table><thead><tr><th>Format</th> <th>Description</th></tr></thead> <tbody><tr><td>alphanumeric</td> <td>A-Z, a-z, 0-9</td></tr> <tr><td>alphanumericextended</td> <td>alphanumeric and special characters _-/</td></tr> <tr><td>char</td> <td>maximum number of characters</td></tr> <tr><td>decimal</td> <td>numeric and optional decimal point</td></tr> <tr><td>email</td> <td>valid email address</td></tr> <tr><td>numeric</td> <td>numeric digits, 0-9</td></tr> <tr><td>url/alphanumericspecial</td> <td>alphanumeric and special characters _-/:&amp;?#=+</td></tr> <tr><td>MD5 hash (characters must be in lower case)</td> <td>32 character hexadecimal number</td></tr></tbody></table> <h2 id="recurring-billing"><a href="#recurring-billing" class="header-anchor">#</a> Recurring Billing</h2> <h3 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h3> <p>The recurring service will allow for merchants to create two methods of recurring payments, one method being a traditional subscription model of a recurring charge on a given date, the other a one-click ad hoc model where the future dates and amounts of payments may be unknown.</p> <h3 id="how-it-works-2"><a href="#how-it-works-2" class="header-anchor">#</a> How it Works</h3> <p>In order to setup a subscription or ad hoc payment you will first need to follow the <a href="https://developers.payfast.co.za/documentation/#web-integration" target="_blank" rel="noopener noreferrer">Web Integration<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> documentation and include the necessary payment parameters for subscriptions or ad hoc payments. Once setup, the buyer will not have to be redirected to PayFast again in order to make payment, and you will be able to perform the below mentioned actions via the API making use of the token sent to your notify URL as part of the ITN. For a subscription, PayFast will charge the credit card according to the data sent in the payment request, for ad hoc payments PayFast will only charge the buyers card when instructed to do so via the API.</p> <img src="/VuePress-Payfast-Docs/images/getting_started_recurring.png" alt="Getting started with recurring billing and Payfast"> <h3 id="subscriptions"><a href="#subscriptions" class="header-anchor">#</a> Subscriptions</h3> <p>The buyer who chooses to enter into a subscription with a merchant will, after checkout, be redirected to PayFast where only the credit card payment option will be available. After a successful first payment there is no need for the buyer to make any further manual payments for the subscription. The recurring amount will be deducted from their credit card in accordance with the frequency, billing date and number of payments (cycles) given. Each successful payment will create an ITN to the merchant and they will be able to manage the subscription via an API or from their PayFast account.</p> <h3 id="ad-hoc-payments"><a href="#ad-hoc-payments" class="header-anchor">#</a> Ad Hoc Payments</h3> <p>A buyer who agrees to enter into an ad hoc payment with a merchant will, after checkout, be redirected to PayFast where only the credit card payment option will be available. After a successful first payment there is no need for the buyer to make any further manual payments. For any future payments the merchant will only need to send a token value to the API to have the associated credit card of the buyer charged. On each successful payment, an ITN will be sent to the merchant and they will be able to manage the subscription via the API or from their PayFast account.</p> <h3 id="r0-00-initial-transaction"><a href="#r0-00-initial-transaction" class="header-anchor">#</a> R0.00 Initial Transaction</h3> <p>It is possible to setup a subscription or ad hoc payment with an initial amount of R0.00. This would be used with subscriptions if the first cycle/period is free (the recurring_amount value would need to be a minimum of R5.00), or, in the case of ad hoc payments it is used to setup the buyers account on the merchants site, allowing for future payments. If the initial amount is R0.00 the buyer will be redirected to PayFast, where they will input their credit card details and go through 3D Secure, but no money will be deducted.</p> <h3 id="integration-options"><a href="#integration-options" class="header-anchor">#</a> Integration Options</h3> <h4 id="pay-now-button"><a href="#pay-now-button" class="header-anchor">#</a> Pay Now Button</h4> <p>One of the easiest ways to create a subscription is to use a <a href="https://www.payfast.co.za/html-buttons/" target="_blank" rel="noopener noreferrer">Pay Now<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> button. The button code can be generated from your <a href="https://www.payfast.co.za/user/login" target="_blank" rel="noopener noreferrer">PayFast dashboard<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Simply fill in the necessary fields (ensuring the subscription fields are populated), click ‘generate’ and copy the code to your website.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Only available for subscriptions. Ad hoc payments will require API integration.</p></div> <h4 id="payment-request"><a href="#payment-request" class="header-anchor">#</a> Payment Request</h4> <p>Should a merchant require a buyer to start a subscription without the buyer going onto a website they can make use of the <a href="https://www.payfast.co.za/request-money/" target="_blank" rel="noopener noreferrer">Request Payment<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> feature on their <a href="https://www.payfast.co.za/user/login" target="_blank" rel="noopener noreferrer">PayFast dashboard<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. The merchant will need to fill in the required fields, then PayFast will send an email on behalf of the merchant with a button to start the subscription. Once the initial payment is made the subscription will be active.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Only available for subscriptions. Ad hoc payments will require API integration.</p></div> <h4 id="e-commerce-and-platform-plugins"><a href="#e-commerce-and-platform-plugins" class="header-anchor">#</a> E-commerce and Platform Plugins</h4> <p>Subscriptions will be supported by a number of PayFast supported plugins which may be downloaded from our shopping carts page. Currently the following plugins support subscriptions:</p> <ul><li>Gravity Forms</li> <li>WP Invoice</li> <li>Paid Membership Pro</li> <li>WHMCS (Uses Ad Hoc)</li> <li>WooCommerce Subscriptions (Uses Ad Hoc, managed by WooThemes)</li> <li>Shopify</li> <li>OpenCart</li> <li>Drupal Commerce</li></ul> <p>Due to some integration requirements, ad hoc payments may not be available via some of our plugins.</p> <h4 id="custom-integration"><a href="#custom-integration" class="header-anchor">#</a> Custom Integration</h4> <p>To accommodate recurring billing for the widest possible merchant base, the traditional custom integration has been extended to allow for the additional subscription fields. Future versions of the API will implement a more RESTful approach with additional security options. Please follow the developer documentation in order to build a custom integration, taking note of the subscription fields on the checkout page, and the return variables.</p> <p>A passphrase is compulsory for all subscriptions which is set on the merchant’s PayFast settings page. Generation of the signature sent to PayFast follows the current documentation. The order of the additional subscription fields is important and can be seen in the table on the checkout page.</p> <h3 id="recurring-maintenance"><a href="#recurring-maintenance" class="header-anchor">#</a> Recurring Maintenance</h3> <h4 id="buyer-perspective"><a href="#buyer-perspective" class="header-anchor">#</a> Buyer Perspective</h4> <p>A buyer is able to login to their PayFast account and view or cancel any of their recurring billings. When cancelled by the buyer, the merchant will be notified via email, and/or an ITN will be sent to the notify_url with the payment_status of CANCELLED. The buyer will be able to change the credit card, including card verification and 3D secure, linked to the subscription or ad hoc payment. Should a buyer not have a PayFast account, they will be able to register at any point to manage their subscriptions.</p> <h4 id="expired-cards"><a href="#expired-cards" class="header-anchor">#</a> Expired Cards</h4> <p>A buyer will be notified via email a month in advance about registered cards which will expire and are linked to an active subscription/agreement. Instructions will be provided in the notification email to help them link a new card to their subscription, so that they do not experience any break in payments or service. A buyer will be permitted to register for subscriptions even if the card is due to expire before the end of the subscription term.</p> <h4 id="merchant-perspective"><a href="#merchant-perspective" class="header-anchor">#</a> Merchant Perspective</h4> <p>The following actions may be accomplished via the PayFast dashboard, as well as the API</p> <h5 id="cancel"><a href="#cancel" class="header-anchor">#</a> Cancel</h5> <p>Any recurring billing type may be cancelled from the PayFast merchant account. The buyer will be notified via email of this action.</p> <h5 id="pause"><a href="#pause" class="header-anchor">#</a> Pause</h5> <p>Should a subscription be paused the remaining payments (cycles) will remain untouched. The end date of the subscription moves on by the number of paused frequency period(s). Effectively the buyer gains a payment gap and the number of payments will still be the same as originally requested. A free month(s) could be provided by pausing (pause) a subscription and reducing the number of cycles by making an update to the subscription.</p> <p>Only the merchant has the functionality to pause or unpause a subscription.</p> <h4 id="failed-payments"><a href="#failed-payments" class="header-anchor">#</a> Failed Payments</h4> <h5 id="subscriber-out-of-funds"><a href="#subscriber-out-of-funds" class="header-anchor">#</a> Subscriber Out of Funds</h5> <p>PayFast will try a number of times to reprocess a payment where the buyer does not have funds on their credit card. On failure, the buyer will be notified, allowing some time for the problem to be resolved. On a complete failure (after X amount of times), the subscription will be ‘locked’ and will need some action from the merchant to reactivate on the PayFast account or via the API pause endpoint.</p> <h5 id="ad-hoc-payments-out-of-funds"><a href="#ad-hoc-payments-out-of-funds" class="header-anchor">#</a> ad hoc payments Out of Funds</h5> <p>When receiving the API call to charge an agreement’s credit card via token, PayFast will attempt to charge the card immediately and the failed response will be returned returned.</p> <h5 id="system-issues"><a href="#system-issues" class="header-anchor">#</a> System Issues</h5> <p>PayFast will resolve any system issue that may cause payment failure. Subscription payments will resume once all systems have been restored.</p> <h2 id="subscription-payments-api-endpoints"><a href="#subscription-payments-api-endpoints" class="header-anchor">#</a> Subscription Payments API Endpoints</h2> <h3 id="url-composition"><a href="#url-composition" class="header-anchor">#</a> URL Composition</h3> <p>The API exposes the following endpoints which will allow Merchants the ability to interact with subscriptions on their accounts.</p> <p>URLs to interact with take the following form:</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>https://api.payfast.co.za/[endpoint]/[token]/[action]?testing=true</p></div> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>[endpoint]</td> <td>This should be set to “subscriptions”</td></tr> <tr><td>[token]</td> <td>The 36 character alphanumeric string returned to your notify URL via the ITN callback which uniquely identifies a subscription</td></tr> <tr><td>[action]</td> <td>This will be the verb describing the intended action to take.</td></tr> <tr><td>testing=true</td> <td>Include this text should you wish to make use of the PayFast sandbox for testing purposes.</td></tr></tbody></table> <h3 id="actions-available-via-the-api"><a href="#actions-available-via-the-api" class="header-anchor">#</a> Actions Available via the API</h3> <p>If using a FORM to post data to any endpoint, all FORMs must submit via normal POST forms and have a hidden value called ‘_method’, set to the appropriate verb.</p> <h4 id="recurring-billing-type-1-subscription-payments"><a href="#recurring-billing-type-1-subscription-payments" class="header-anchor">#</a> Recurring Billing Type 1 – Subscription Payments</h4> <h4 id="get-ping"><a href="#get-ping" class="header-anchor">#</a> [GET] ping</h4> <p>Used to check if the API is responding to requests.</p> <p><span style="background-color:#e6e6ff;">https://api.payfast.co.za/ping</span></p> <table><thead><tr><th>NAME</th> <th>DESCRIPTION</th> <th>REQUIRED</th> <th>FORMAT</th></tr></thead> <tbody><tr><td>merchant-id</td> <td>Header, the Merchant ID as given by the PayFast system.</td> <td>Yes</td> <td>numeric, 8 char</td></tr> <tr><td>version</td> <td>Header, the PayFast API version.</td> <td>Yes</td> <td>v1</td></tr> <tr><td>timestamp</td> <td>Header, the current timestamp.</td> <td>Yes</td> <td>ISO-8601 date and time, YYYY-MM-DDTHH:MM:SS[+HH:MM]</td></tr> <tr><td>signature</td> <td>Header, MD5 hash of the alphabetised submitted header and body variables, as well as the passphrase.</td> <td>Yes</td> <td>MD5 hash, characters must be in lower case</td></tr></tbody></table> <pre>Successful ping response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token string">&quot;API V1&quot;</span>
</code></pre></div><pre>Unsuccessful ping response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">404</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="put-pause"><a href="#put-pause" class="header-anchor">#</a> [PUT] pause</h4> <p>Pause a subscription, for a duration indicated by a ‘cycles’ payload variable.</p> <p><span style="background-color:#e6e6ff;">https://api.payfast.co.za/subscriptions/dc0521d3-55fe-269b-fa00-b647310d760f/pause</span></p> <table><thead><tr><th>NAME</th> <th>DESCRIPTION</th> <th>REQUIRED</th> <th>FORMAT</th></tr></thead> <tbody><tr><td>merchant-id</td> <td>Header, the Merchant ID as given by the PayFast system.</td> <td>Yes</td> <td>numeric, 8 char</td></tr> <tr><td>version</td> <td>Header, the PayFast API version.</td> <td>Yes</td> <td>v1</td></tr> <tr><td>timestamp</td> <td>Header, the current timestamp.</td> <td>Yes</td> <td>ISO-8601 date and time, YYYY-MM-DDTHH:MM:SS[+HH:MM]</td></tr> <tr><td>signature</td> <td>Header, MD5 hash of the alphabetised submitted header and body variables, as well as the passphrase.</td> <td>Yes</td> <td>MD5 hash, characters must be in lower case</td></tr> <tr><td>cycles</td> <td>Body, number of cycles to pause the subscription for. Default is 1 if not given.</td> <td>Optional</td> <td>numeric</td></tr></tbody></table> <pre>Successful pause response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><pre>Unsuccessful pause response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="put-cancel"><a href="#put-cancel" class="header-anchor">#</a> [PUT] cancel</h4> <p>This will cancel a subscription entirely.</p> <p><span style="background-color:#e6e6ff;">https://api.payfast.co.za/subscriptions/dc0521d3-55fe-269b-fa00-b647310d760f/cancel</span></p> <table><thead><tr><th>NAME</th> <th>DESCRIPTION</th> <th>REQUIRED</th> <th>FORMAT</th></tr></thead> <tbody><tr><td>merchant-id</td> <td>Header, the Merchant ID as given by the PayFast system.</td> <td>Yes</td> <td>numeric, 8 char</td></tr> <tr><td>version</td> <td>Header, the PayFast API version.</td> <td>Yes</td> <td>v1</td></tr> <tr><td>timestamp</td> <td>Header, the current timestamp.</td> <td>Yes</td> <td>ISO-8601 date and time, YYYY-MM-DDTHH:MM:SS[+HH:MM]</td></tr> <tr><td>signature</td> <td>Header, MD5 hash of the alphabetised submitted header and body variables, as well as the passphrase.</td> <td>Yes</td> <td>MD5 hash, characters must be in lower case</td></tr></tbody></table> <pre>Successful cancel response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><pre>Unsuccessful cancel response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="patch-update"><a href="#patch-update" class="header-anchor">#</a> [PATCH] update</h4> <p>This allows for multiple subscription values to be updated</p> <p><span style="background-color:#e6e6ff;">https://api.payfast.co.za/subscriptions/dc0521d3-55fe-269b-fa00-b647310d760f/update</span></p> <table><thead><tr><th>NAME</th> <th>DESCRIPTION</th> <th>REQUIRED</th> <th>FORMAT</th></tr></thead> <tbody><tr><td>merchant-id</td> <td>Header, the Merchant ID as given by the PayFast system.</td> <td>Yes</td> <td>numeric, 8 char</td></tr> <tr><td>version</td> <td>Header, the PayFast API version.</td> <td>Yes</td> <td>v1</td></tr> <tr><td>timestamp</td> <td>Header, the current timestamp.</td> <td>Yes</td> <td>ISO-8601 date and time, YYYY-MM-DDTHH:MM:SS[+HH:MM]</td></tr> <tr><td>signature</td> <td>Header, MD5 hash of the alphabetised submitted header and body variables, as well as the passphrase.</td> <td>Yes</td> <td>MD5 hash, characters must be in lower case</td></tr> <tr><td>cycles</td> <td>Body, the number of cycles for the subscription.</td> <td>Optional</td> <td>numeric</td></tr> <tr><td>frequency</td> <td>Body, the frequency for the subscription</td> <td>Optional</td> <td>numeric</td></tr> <tr><td>run_date</td> <td>Body, the next run date for the subscription.</td> <td>Optional</td> <td>YYYY-MM-DD</td></tr> <tr><td>amount</td> <td>Body, the amount which the buyer must pay, in CENTS (ZAR).</td> <td>Optional</td> <td>numeric</td></tr></tbody></table> <pre>Successful update response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;token&quot;</span><span class="token operator">:</span><span class="token string">&quot;a3b3ae55-ab8b-b388-df23-4e6882b86ce0&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;amount&quot;</span><span class="token operator">:</span><span class="token string">&quot;1628&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;cycles&quot;</span><span class="token operator">:</span><span class="token string">&quot;14&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;cycles_complete&quot;</span><span class="token operator">:</span><span class="token string">&quot;9&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;frequency&quot;</span><span class="token operator">:</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;run_date&quot;</span><span class="token operator">:</span><span class="token string">&quot;2016-07-04&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><pre>Unsuccessful update response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The body must contain at least one of the optional payload variables.</p></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The amount field in the API is in cents and not decimal notation as per normal PayFast integrations.</p></div> <h4 id="get-fetch"><a href="#get-fetch" class="header-anchor">#</a> [GET] fetch</h4> <p>Returns a JSON object containing the subscription details</p> <p><span style="background-color:#e6e6ff;">https://api.payfast.co.za/subscriptions/dc0521d3-55fe-269b-fa00-b647310d760f/fetch</span></p> <table><thead><tr><th>NAME</th> <th>DESCRIPTION</th> <th>REQUIRED</th> <th>FORMAT</th></tr></thead> <tbody><tr><td>merchant-id</td> <td>Header, the Merchant ID as given by the PayFast system.</td> <td>Yes</td> <td>numeric, 8 char</td></tr> <tr><td>version</td> <td>Header, the PayFast API version.</td> <td>Yes</td> <td>v1</td></tr> <tr><td>timestamp</td> <td>Header, the current timestamp.</td> <td>Yes</td> <td>ISO-8601 date and time, YYYY-MM-DDTHH:MM:SS[+HH:MM]</td></tr> <tr><td>signature</td> <td>Header, MD5 hash of the alphabetised submitted header and body variables, as well as the passphrase.</td> <td>Yes</td> <td>MD5 hash, characters must be in lower case</td></tr></tbody></table> <pre>Successful fetch response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;token&quot;</span><span class="token operator">:</span><span class="token string">&quot;a3b3ae55-ab8b-b388-df23-4e6882b86ce0&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;amount&quot;</span><span class="token operator">:</span><span class="token string">&quot;1628&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;cycles&quot;</span><span class="token operator">:</span><span class="token string">&quot;14&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;cycles_complete&quot;</span><span class="token operator">:</span><span class="token string">&quot;9&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;frequency&quot;</span><span class="token operator">:</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;run_date&quot;</span><span class="token operator">:</span><span class="token string">&quot;2016-07-04&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><pre>Unsuccessful fetch response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="curl-examples"><a href="#curl-examples" class="header-anchor">#</a> CURL Examples</h3> <p>The examples below demonstrate cURL calls containing the following:</p> <ul><li>HTTP Method: PUT</li> <li>URL: https://api.payfast.co.za/</li> <li>Endpoint: subscriptions/[Token]/[Action]</li> <li>The calls are made to v1 (version 1) of the API. The merchant-id, version, timestamp and signature are all included as request headers.</li></ul> <h4 id="pausing-a-subscription"><a href="#pausing-a-subscription" class="header-anchor">#</a> Pausing a subscription</h4> <p><span style="background-color:#e6e6ff;">curl -v -X PUT -H “merchant-id: 10000100” -H “version: v1” -H “timestamp=2016-04-01T12:00:01” -H “signature=840654b40a8b312e54650e1613696b44” https://api.payfast.co.za/subscriptions/dc0521d3-55fe-269b-fa00-b647310d760f/pause</span> <br><br>An example of the request information sent can be seen below:</p> <p><span style="background-color:#e6e6ff;">&gt;PUT https://api.payfast.co.za/subscriptions/dc0521d3-55fe-269b-fa00-b647310d760f/pause HTTP/1.1</span><br> <span style="background-color:#e6e6ff;">&gt;User-Agent: curl/7.37.0</span><br> <span style="background-color:#e6e6ff;">&gt;Host: api.payfast.co.za</span><br> <span style="background-color:#e6e6ff;">&gt;Accept: <em>/</em></span><br> <span style="background-color:#e6e6ff;">&gt;merchant-id: 10000100</span><br> <span style="background-color:#e6e6ff;">&gt;version: v1</span><br> <span style="background-color:#e6e6ff;">&gt;timestamp: 2016-04-01T12:00:01</span><br> <span style="background-color:#e6e6ff;">&gt;signature: 840654b40a8b312e54650e1613696b44</span><br> <span style="background-color:#e6e6ff;">&gt;Content-Length: 0</span><br> <span style="background-color:#e6e6ff;">&gt;Content-Type: application/x-www-form-urlencoded</span><br></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'Your Pay Load Added'</span><span class="token punctuation">;</span>
<span class="token variable">$token</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'dc0521d3-55fe-269b-fa00-b647310d760f'</span><span class="token punctuation">;</span>
<span class="token comment">// Set up cURL, add &quot;?testing=true&quot; to the end when testing</span>
<span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span> <span class="token double-quoted-string string">&quot;https://api.payfast.co.za/subscriptions/&quot;</span><span class="token punctuation">.</span> <span class="token variable">$token</span> <span class="token punctuation">.</span><span class="token double-quoted-string string">&quot;/pause&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token boolean constant">false</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_SSL_VERIFYPEER</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_TIMEOUT</span><span class="token punctuation">,</span> <span class="token number">60</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_CUSTOMREQUEST</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;PUT&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// For the body values such as amount, frequency, &amp; date</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_POSTFIELDS</span><span class="token punctuation">,</span> <span class="token function">http_build_query</span><span class="token punctuation">(</span> <span class="token variable">$payload</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_VERBOSE</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HTTPHEADER</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token single-quoted-string string">'version: v1'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'merchant-id: 10000100'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'signature: 840654b40a8b312e54650e1613696b44'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'timestamp: 2016-04-01T12:00:01'</span> 
<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Execute and close cURL</span>
<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span> <span class="token variable">$ch</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_close</span><span class="token punctuation">(</span> <span class="token variable">$ch</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><h4 id="return-variables"><a href="#return-variables" class="header-anchor">#</a> Return Variables</h4> <p>All responses from the API follow a standard format. It is a JSON encoded string containing code, status and data elements. The data element may contain more than one message.</p> <p>Outline of a JSON formatted response:</p> <ul><li>code: The HTTP status code for the result</li> <li>status: A more verbose description of the result</li> <li>data: Will contain a response of either true or false for the action and may also contain one or more description(s) for the reason of the result</li></ul> <pre>Example of success response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
        <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
        <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;response&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Success&quot;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre></div><pre>Example of a failure response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
        <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
        <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;failed&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;response&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Failure&quot;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="errors-and-causes"><a href="#errors-and-causes" class="header-anchor">#</a> Errors and Causes</h3> <p>The following errors can be expected during authentication when connecting to PayFast.</p> <table><thead><tr><th>CODE</th> <th>ERROR MESSAGE</th> <th>REASON</th></tr></thead> <tbody><tr><td>400</td> <td>Required variables not present in request<br><br>Value for signature is not in the expected format<br><br>API version is not valid<br><br>Signature not present in headers</td> <td>The request is missing some or all of the required fields.<br><br>Generated when the merchant signature provided is not an MD5 hash, or is malformed.<br><br>Issued when the version header refers to a version that does not exist, or is malformed.<br><br>The signature has not been provided.</td></tr> <tr><td>401</td> <td>Merchant not found<br><br>Request origin not recognised<br><br>Request origin could not be verified<br><br>Merchant authorisation failed</td> <td>The given merchant ID was not found.<br><br>Generated when the request does not contain a REMOTE_ADDR value.<br><br>Occurs when the request is made from a location not specified in the whitelist.<br><br>The signature is incorrect.</td></tr> <tr><td>404</td> <td>Service / endpoint not found</td> <td>The endpoint does not exist or the requesting merchant does not have permission to access.</td></tr> <tr><td>429</td> <td>Signature rate limit reached, please try again in a few minutes</td> <td>The rate limit was hit.</td></tr> <tr><td>500</td> <td>Application Error<br><br>Communication Failure</td> <td>Application Error.<br><br>Networking issue with the API.</td></tr></tbody></table> <h2 id="ad-hoc-payments-api-endpoints"><a href="#ad-hoc-payments-api-endpoints" class="header-anchor">#</a> Ad Hoc Payments API Endpoints</h2> <h3 id="url-composition-2"><a href="#url-composition-2" class="header-anchor">#</a> URL Composition</h3> <p>The API exposes the following endpoints which will allow Merchants the ability to interact with subscriptions on their accounts.</p> <p>URLs to interact with take the following form:</p> <details class="custom-block details"><summary>DETAILS</summary> <p>https://api.payfast.co.za/[endpoint]/[token]/[action]?testing=true</p></details> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>[endpoint]</td> <td>This should be set to “subscriptions”</td></tr> <tr><td>[token]</td> <td>The 36 character alphanumeric string returned to your notify URL via the ITN callback which uniquely identifies a subscription</td></tr> <tr><td>[action]</td> <td>This will be the verb describing the intended action to take.</td></tr> <tr><td>testing=true</td> <td>Include this text should you wish to make use of the PayFast sandbox for testing purposes.</td></tr></tbody></table> <h3 id="actions-available-via-the-api-2"><a href="#actions-available-via-the-api-2" class="header-anchor">#</a> Actions Available via the API</h3> <p>If using a FORM to post data to any endpoint, all FORMs must submit via normal POST forms and have a hidden value called ‘_method’, set to the appropriate verb.</p> <h3 id="recurring-billing-type-2-ad-hoc-payments"><a href="#recurring-billing-type-2-ad-hoc-payments" class="header-anchor">#</a> Recurring Billing Type 2 – Ad Hoc Payments</h3> <h4 id="get-ping-2"><a href="#get-ping-2" class="header-anchor">#</a> [GET] ping</h4> <p>Used to check if the API is responding to requests.</p> <p><span style="background-color:#e6e6ff;">https://api.payfast.co.za/ping</span></p> <table><thead><tr><th>NAME</th> <th>DESCRIPTION</th> <th>REQUIRED</th> <th>FORMAT</th></tr></thead> <tbody><tr><td>merchant-id</td> <td>Header, the Merchant ID as given by the PayFast system.</td> <td>Yes</td> <td>numeric, 8 char</td></tr> <tr><td>version</td> <td>Header, the PayFast API version.</td> <td>Yes</td> <td>v1</td></tr> <tr><td>timestamp</td> <td>Header, the current timestamp.</td> <td>Yes</td> <td>ISO-8601 date and time, YYYY-MM-DDTHH:MM:SS[+HH:MM]</td></tr> <tr><td>signature</td> <td>Header, MD5 hash of the alphabetised submitted header and body variables, as well as the passphrase.</td> <td>Yes</td> <td>MD5 hash, characters must be in lower case</td></tr></tbody></table> <pre>Successful ping response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token string">&quot;API V1&quot;</span>
</code></pre></div><pre>Unsuccessful ping response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">404</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="post-adhoc"><a href="#post-adhoc" class="header-anchor">#</a> [POST] adhoc</h4> <p>Charge an ad hoc subscription based on token.</p> <p><span style="background-color:#e6e6ff;">https://api.payfast.co.za/subscriptions/dc0521d3-55fe-269b-fa00-b647310d760f/adhoc</span></p> <table><thead><tr><th>NAME</th> <th>DESCRIPTION</th> <th>REQUIRED</th> <th>FORMAT</th></tr></thead> <tbody><tr><td>merchant-id</td> <td>Header, the Merchant ID as given by the PayFast system.</td> <td>Yes</td> <td>numeric, 8 char</td></tr> <tr><td>version</td> <td>Header, the PayFast API version.</td> <td>Yes</td> <td>v1</td></tr> <tr><td>timestamp</td> <td>Header, the current timestamp.</td> <td>Yes</td> <td>ISO-8601 date and time, YYYY-MM-DDTHH:MM:SS[+HH:MM]</td></tr> <tr><td>signature</td> <td>Header, MD5 hash of the alphabetised submitted header and body variables, as well as the passphrase.</td> <td>Yes	MD5 hash, characters must be in lower case</td> <td></td></tr> <tr><td>amount</td> <td>Body, the amount which the buyer must pay, in CENTS (ZAR).</td> <td>Yes</td> <td>numeric</td></tr> <tr><td>item_name</td> <td>Body, the name of the item being charged for.</td> <td>Yes</td> <td>alphanumeric</td></tr> <tr><td>item_description</td> <td>Body, the description of the item being charged for.</td> <td>optional</td> <td>alphanumeric</td></tr> <tr><td>itn</td> <td>Body, specify whether an ITN must be sent for the ad hoc charge (1 by default).</td> <td>optional</td> <td>true or false</td></tr> <tr><td>m_payment_id</td> <td>Body, unique payment ID on the merchant’s system.</td> <td>optional</td> <td>alphanumeric</td></tr> <tr><td>cc_cvv</td> <td>Body, the credit card cvv number.</td> <td>optional</td> <td>numeric</td></tr></tbody></table> <pre>Successful Adhoc response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><pre>Unsuccessful ping response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The amount field in the API is in cents and not decimal notation as per normal PayFast integrations.</p></div> <h4 id="get-fetch-2"><a href="#get-fetch-2" class="header-anchor">#</a> [GET] fetch</h4> <p>Returns a JSON object containing the subscription details.</p> <p><span style="background-color:#e6e6ff;">https://api.payfast.co.za/subscriptions/dc0521d3-55fe-269b-fa00-b647310d760f/fetch</span></p> <table><thead><tr><th>NAME</th> <th>DESCRIPTION</th> <th>REQUIRED</th> <th>FORMAT</th></tr></thead> <tbody><tr><td>merchant-id</td> <td>Header, the Merchant ID as given by the PayFast system.</td> <td>Yes</td> <td>numeric, 8 char</td></tr> <tr><td>version</td> <td>Header, the PayFast API version.</td> <td>Yes</td> <td>v1</td></tr> <tr><td>timestamp</td> <td>Header, the current timestamp.</td> <td>Yes</td> <td>ISO-8601 date and time, YYYY-MM-DDTHH:MM:SS[+HH:MM]</td></tr> <tr><td>signature</td> <td>Header, MD5 hash of the alphabetised submitted header and body variables, as well as the passphrase.</td> <td>Yes</td> <td>MD5 hash, characters must be in lower case</td></tr></tbody></table> <pre>Successful fetch response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;token&quot;</span><span class="token operator">:</span><span class="token string">&quot;a3b3ae55-ab8b-b388-df23-4e6882b86ce0&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><pre>Unsuccessful fetch response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="put-cancel-2"><a href="#put-cancel-2" class="header-anchor">#</a> [PUT] cancel</h4> <p>This will cancel a subscription entirely.</p> <p><span style="background-color:#e6e6ff;">https://api.payfast.co.za/subscriptions/dc0521d3-55fe-269b-fa00-b647310d760f/cancel</span></p> <table><thead><tr><th>NAME</th> <th>DESCRIPTION</th> <th>REQUIRED</th> <th>FORMAT</th></tr></thead> <tbody><tr><td>merchant-id</td> <td>Header, the Merchant ID as given by the PayFast system.</td> <td>Yes</td> <td>numeric, 8 char</td></tr> <tr><td>version</td> <td>Header, the PayFast API version.</td> <td>Yes</td> <td>v1</td></tr> <tr><td>timestamp</td> <td>Header, the current timestamp.</td> <td>Yes</td> <td>ISO-8601 date and time, YYYY-MM-DDTHH:MM:SS[+HH:MM]</td></tr> <tr><td>signature</td> <td>Header, MD5 hash of the alphabetised submitted header and body variables, as well as the passphrase.</td> <td>Yes</td> <td>MD5 hash, characters must be in lower case</td></tr></tbody></table> <pre>Successful cancel response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><pre>Unsuccessful cancel response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="curl-examples-2"><a href="#curl-examples-2" class="header-anchor">#</a> CURL Examples</h3> <p>The examples below demonstrate cURL calls containing the following:</p> <ul><li>HTTP Method: POST</li> <li>URL: https://api.payfast.co.za/</li> <li>Endpoint: subscriptions/[Token]/[Action] The calls are made to v1 (version 1) of the API. The merchant-id, version, timestamp and signature are all included as request headers. The amount, item_name and item_description are included in the request body.</li></ul> <h4 id="charging-a-token"><a href="#charging-a-token" class="header-anchor">#</a> Charging a Token</h4> <p><span style="background-color:#e6e6ff;">&gt; PUT https://api.payfast.co.za/subscriptions/dc0521d3-55fe-269b-fa00-b647310d760f/adhoc HTTP/1.1</span> <br><br> <span style="background-color:#e6e6ff;">&gt; User-Agent: curl/7.37.0</span> <br><br> <span style="background-color:#e6e6ff;">&gt; Host: api.payfast.co.za</span> <br><br> <span style="background-color:#e6e6ff;">&gt; Accept: <em>/</em></span> <br><br> <span style="background-color:#e6e6ff;">&gt; merchant-id: 10000100</span> <br><br> <span style="background-color:#e6e6ff;">&gt; version: v1</span> <br><br> <span style="background-color:#e6e6ff;">&gt; timestamp: 2016-04-01T12:00:01</span> <br><br> <span style="background-color:#e6e6ff;">&gt; signature: 840654b40a8b312e54650e1613696b44</span> <br><br> <span style="background-color:#e6e6ff;">&gt; Content-Length: 0</span> <br><br> <span style="background-color:#e6e6ff;">&gt; Content-Type: application/x-www-form-urlencoded</span></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">// Array used for CURLOPT_POSTFIELDS</span>
<span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token single-quoted-string string">'amount'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'$amount'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'item_name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'$itemName'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'item_description'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'$itemDescription'</span> <span class="token comment">//optional</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token variable">$token</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'dc0521d3-55fe-269b-fa00-b647310d760f'</span><span class="token punctuation">;</span>
<span class="token comment">// Set up cURL, add &quot;?testing=true&quot; to the end when testing</span>
<span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span> <span class="token double-quoted-string string">&quot;https://api.payfast.co.za/subscriptions/&quot;</span><span class="token punctuation">.</span> <span class="token variable">$token</span> <span class="token punctuation">.</span><span class="token double-quoted-string string">&quot;/adhoc&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token boolean constant">false</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_SSL_VERIFYPEER</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_TIMEOUT</span><span class="token punctuation">,</span> <span class="token number">60</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_CUSTOMREQUEST</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;POST&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// For the body values such as amount, item_name, &amp; item_description</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_POSTFIELDS</span><span class="token punctuation">,</span> <span class="token function">http_build_query</span><span class="token punctuation">(</span> <span class="token variable">$payload</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_VERBOSE</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HTTPHEADER</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token single-quoted-string string">'version: v1'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'merchant-id: 10000100'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'signature: 840654b40a8b312e54650e1613696b44'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'timestamp: 2016-04-01T12:00:01'</span> 
<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Execute and close cURL</span>
<span class="token variable">$response</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span> <span class="token variable">$ch</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_close</span><span class="token punctuation">(</span> <span class="token variable">$ch</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><pre>Example of a success response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
         <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
         <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
         <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                 <span class="token property">&quot;response&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                 <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Success&quot;</span>
         <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div><pre>Example of a failure response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
        <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
        <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;failed&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;response&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Failure&quot;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="return-variables-2"><a href="#return-variables-2" class="header-anchor">#</a> Return Variables</h3> <p>All responses from the API follow a standard format. It is a JSON encoded string containing code, status and data elements. The data element may contain more than one message.
Outline of a JSON formatted response:</p> <ul><li>code: The HTTP status code for the result</li> <li>status: A more verbose description of the result</li> <li>data: Will contain a response of either true or false for the action and may also contain one or more description(s) for the reason of the result</li></ul> <h3 id="errors-and-causes-2"><a href="#errors-and-causes-2" class="header-anchor">#</a> Errors and Causes</h3> <p>The following errors can be expected during authentication when connecting to PayFast.</p> <table><thead><tr><th>CODE</th> <th>ERROR MESSAGE</th> <th>REASON</th></tr></thead> <tbody><tr><td>400</td> <td>Required variables not present in request<br><br>Value for signature is not in the expected format<br><br>API version is not valid<br><br>Signature not present in headers</td> <td>The request is missing some or all of the required fields.<br><br>Generated when the merchant signature provided is not an MD5 hash, or is malformed.<br><br>Issued when the version header refers to a version that does not exist, or is malformed.<br><br>The signature has not been provided.</td></tr> <tr><td>401</td> <td>Merchant not found<br><br>Request origin not recognised<br><br>Request origin could not be verified<br><br>Merchant authorisation failed</td> <td>The given merchant ID was not found.<br><br>Generated when the request does not contain a REMOTE_ADDR value.<br><br>Occurs when the request is made from a location not specified in the whitelist.<br><br>The signature is incorrect.</td></tr> <tr><td>404</td> <td>Service / endpoint not found</td> <td>The endpoint does not exist or the requesting merchant does not have permission to access.</td></tr> <tr><td>429</td> <td>Signature rate limit reached, please try again in a few minutes</td> <td>The rate limit was hit.</td></tr> <tr><td>500</td> <td>Application Error<br><br>Communication Failure</td> <td>Application Error.<br><br>Networking issue with the API.</td></tr></tbody></table> <h2 id="payfast-account"><a href="#payfast-account" class="header-anchor">#</a> PayFast Account</h2> <h3 id="available-actions-for-accounts"><a href="#available-actions-for-accounts" class="header-anchor">#</a> Available actions for accounts</h3> <p>The actions described below are available via the API in order for merchants to interact with their PayFast account.</p> <h3 id="transaction-history"><a href="#transaction-history" class="header-anchor">#</a> Transaction History</h3> <p>The URL to interact with will take the following form:</p> <details class="custom-block details"><summary>DETAILS</summary> <p>https://api.payfast.co.za/transactions/history/[timeframe]</p></details> <h4 id="get-history"><a href="#get-history" class="header-anchor">#</a> [GET] history</h4> <p>Obtain the transaction history for given a period.</p> <p><span style="background-color:#e6e6ff;">https://api.payfast.co.za/transactions/history?from=2017-01-01&amp;to=2017-02-01</span></p> <table><thead><tr><th>NAME</th> <th>DESCRIPTION</th> <th>REQUIRED</th> <th>FORMAT</th></tr></thead> <tbody><tr><td>merchant-id</td> <td>Header, the Merchant ID as given by the PayFast system.</td> <td>Yes</td> <td>numeric, 8 char</td></tr> <tr><td>version</td> <td>Header, the PayFast API version.</td> <td>Yes</td> <td>v1</td></tr> <tr><td>timestamp</td> <td>Header, the current timestamp.</td> <td>Yes</td> <td>ISO-8601 date and time, YYYY-MM-DDTHH:MM:SS[+HH:MM]</td></tr> <tr><td>signature</td> <td>Header, MD5 hash of the alphabetised submitted header and body variables, as well as the passphrase.</td> <td>Yes</td> <td>MD5 hash, characters must be in lower case</td></tr> <tr><td>from</td> <td>Body, start date for the time period. Defaults to current month</td> <td>Optional</td> <td>YYYY-MM-DD</td></tr> <tr><td>to</td> <td>Body, end date for the time period. Defaults to current date</td> <td>Optional</td> <td>YYYY-MM-DD</td></tr></tbody></table> <details class="custom-block details"><summary>DETAILS</summary> <p>A successful daily response will return comma-separated values (CSV) of required the transactions.</p></details> <pre>Unsuccessful history response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="get-weekly"><a href="#get-weekly" class="header-anchor">#</a> [GET] weekly</h4> <p>Obtain the transaction history for a given weekly period.</p> <p><span style="background-color:#e6e6ff;">https://api.payfast.co.za/transactions/history/weekly?date=2017-01-01</span></p> <table><thead><tr><th>NAME</th> <th>DESCRIPTION</th> <th>REQUIRED</th> <th>FORMAT</th></tr></thead> <tbody><tr><td>merchant-id</td> <td>Header, the Merchant ID as given by the PayFast system.</td> <td>Yes</td> <td>numeric, 8 char</td></tr> <tr><td>version</td> <td>Header, the PayFast API version.</td> <td>Yes</td> <td>v1</td></tr> <tr><td>timestamp</td> <td>Header, the current timestamp.</td> <td>Yes</td> <td>ISO-8601 date and time, YYYY-MM-DDTHH:MM:SS[+HH:MM]</td></tr> <tr><td>signature</td> <td>Header, MD5 hash of the alphabetised submitted header and body variables, as well as the passphrase.</td> <td>Yes</td> <td>MD5 hash, characters must be in lower case</td></tr> <tr><td>date</td> <td>Body, date of the time period. Defaults to current week</td> <td>Optional</td> <td>YYYY-MM-DD</td></tr></tbody></table> <details class="custom-block details"><summary>DETAILS</summary> <p>A successful weekly response will return comma-separated values (CSV) of required the transactions.</p></details> <div class="language- extra-class"><pre class="language-text"><code>&lt;pre&gt;Unsuccessful weekly response&lt;/pre&gt;
```JSON
{
  &quot;code&quot;:500,
  &quot;status&quot;:&quot;error&quot;,
  &quot;data&quot;:{
    &quot;response&quot;:false
  }
}
</code></pre></div><h4 id="get-monthly"><a href="#get-monthly" class="header-anchor">#</a> [GET] monthly</h4> <p>Obtain the transaction history for a given monthly period.</p> <p><span style="background-color:#e6e6ff;">https://api.payfast.co.za/transactions/history/monthly?date=2017-01</span></p> <table><thead><tr><th>NAME</th> <th>DESCRIPTION</th> <th>REQUIRED</th> <th>FORMAT</th></tr></thead> <tbody><tr><td>merchant-id</td> <td>Header, the Merchant ID as given by the PayFast system.</td> <td>Yes</td> <td>numeric, 8 char</td></tr> <tr><td>version</td> <td>Header, the PayFast API version.</td> <td>Yes</td> <td>v1</td></tr> <tr><td>timestamp</td> <td>Header, the current timestamp.</td> <td>Yes</td> <td>ISO-8601 date and time, YYYY-MM-DDTHH:MM:SS[+HH:MM]</td></tr> <tr><td>signature</td> <td>Header, MD5 hash of the alphabetised submitted header and body variables, as well as the passphrase.</td> <td>Yes</td> <td>MD5 hash, characters must be in lower case</td></tr> <tr><td>date</td> <td>Body, date of the time period. Defaults to current week</td> <td>Optional</td> <td>YYYY-MM-DD</td></tr></tbody></table> <details class="custom-block details"><summary>DETAILS</summary> <p>A successful monthly response will return comma-separated values (CSV) of required the transactions.</p></details> <pre>Unsuccessful monthly response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="credit-card-transaction-query"><a href="#credit-card-transaction-query" class="header-anchor">#</a> Credit Card Transaction Query</h2> <p>The URL to interact with will take the following forms below.</p> <h3 id="live-endpoint"><a href="#live-endpoint" class="header-anchor">#</a> Live Endpoint:</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>https://api.payfast.co.za/process/query/[Transaction Token / Payfast Payment ID]</p></div> <h3 id="sandbox-endpoint"><a href="#sandbox-endpoint" class="header-anchor">#</a> Sandbox Endpoint:</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>https://api.payfast.co.za/process/query/[Transaction Token / Payfast Payment ID]?testing=true</p></div> <p>When testing, an optional parameter “testing=true” needs to be appended. This will route transactions to a sandbox environment where no production data is returned.</p> <p>The Transaction token, or PayFast payment id, needs to be sent to retrieve the transaction details.</p> <h4 id="get-query"><a href="#get-query" class="header-anchor">#</a> [GET] query</h4> <p>Query a credit card transaction.</p> <p><span style="background-color:#e6e6ff;">https://api.payfast.co.za/process/query/01d2e4c7-28c8-3a86-151f-eab5357da649</span><br><br> <span style="background-color:#e6e6ff;">https://api.payfast.co.za/process/query/69</span></p> <table><thead><tr><th>NAME</th> <th>DESCRIPTION</th> <th>REQUIRED</th> <th>FORMAT</th></tr></thead> <tbody><tr><td>merchant-id</td> <td>Header, the Merchant ID as given by the PayFast system.</td> <td>Yes</td> <td>numeric, 8 char</td></tr> <tr><td>version</td> <td>Header, the PayFast API version.</td> <td>Yes</td> <td>v1</td></tr> <tr><td>timestamp</td> <td>Header, the current timestamp.</td> <td>Yes</td> <td>ISO-8601 date and time, YYYY-MM-DDTHH:MM:SS[+HH:MM]</td></tr> <tr><td>signature</td> <td>Header, MD5 hash of the alphabetised submitted header and body variables, as well as the passphrase.</td> <td>Yes</td> <td>MD5 hash, characters must be in lower case</td></tr></tbody></table> <pre>Successful query response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;pf_payment_id&quot;</span><span class="token operator">:</span><span class="token string">&quot;69&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;m_payment_id&quot;</span><span class="token operator">:</span><span class="token string">&quot;232345&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;COMPLETE&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;amount&quot;</span><span class="token operator">:</span><span class="token string">&quot;3600&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;cc_status&quot;</span><span class="token operator">:</span><span class="token string">&quot;00&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;cc_message&quot;</span><span class="token operator">:</span><span class="token string">&quot;Approved or completed successfully (00)&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span><span class="token string">&quot;Success&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><pre>Unsuccessful query response</pre> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;response&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="api-validation"><a href="#api-validation" class="header-anchor">#</a> API Validation</h2> <h3 id="curl-examples-3"><a href="#curl-examples-3" class="header-anchor">#</a> CURL Examples</h3> <p>The example below demonstrates a cURL call containing the following:</p> <ul><li>HTTP Method: GET</li> <li>URL: https://api.payfast.co.za/transactions/history</li> <li>Endpoint: /daily. The call is made to v1 (version 1) of the API. The merchant-id, version, timestamp and signature are all included as request headers. The date and format are included in the request body.</li></ul> <p><span style="background-color:#e6e6ff;">curl -v -X PUT -H “merchant-id: 10000100” -H “version: v1” -H “timestamp: 2017-01-01T12:00:00” -H “signature: 840654b40a8b312e54650e1613696b44” https://api.payfast.co.za/transactions/history/daily</span><br><br>
An example of the request information sent can be seen below:</p> <p><span style="background-color:#e6e6ff;">&gt; GET https://api.payfast.co.za/transactions/history/daily HTTP/1.1</span><br><br> <span style="background-color:#e6e6ff;">&gt; User-Agent: curl/7.37.0</span><br><br> <span style="background-color:#e6e6ff;">&gt; Host: api.payfast.co.za </span><br><br> <span style="background-color:#e6e6ff;">&gt; Accept: <em>/</em></span><br><br> <span style="background-color:#e6e6ff;">&gt; merchant-id: 10000100</span><br><br> <span style="background-color:#e6e6ff;">&gt; version: v1 </span><br><br> <span style="background-color:#e6e6ff;">&gt; timestamp: 2017-01-01T12:00:00</span><br><br> <span style="background-color:#e6e6ff;">&gt; version: v1 </span><br><br> <span style="background-color:#e6e6ff;">&gt; signature: 840654b40a8b312e54650e1613696b44</span><br><br> <span style="background-color:#e6e6ff;">&gt; Content-Length: 0 </span><br><br> <span style="background-color:#e6e6ff;">&gt; Content-Type: application/x-www-form-urlencoded</span><br><br></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">// URL for curl_init</span>
<span class="token variable">$url</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;https://api.payfast.co.za/transactions/history/daily?date=2017-01-01&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// Set up cURL</span>
<span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span> <span class="token variable">$url</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token boolean constant">false</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_SSL_VERIFYPEER</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_TIMEOUT</span><span class="token punctuation">,</span> <span class="token number">60</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_CUSTOMREQUEST</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;GET&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_VERBOSE</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_setopt</span><span class="token punctuation">(</span> <span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HTTPHEADER</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token single-quoted-string string">'version: v1'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'merchant-id: 10000100'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'signature: 840654b40a8b312e54650e1613696b44'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'timestamp: 2017-01-01T12:00:00'</span> 
<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Execute and close cURL</span>
<span class="token variable">$response</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span> <span class="token variable">$ch</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curl_close</span><span class="token punctuation">(</span> <span class="token variable">$ch</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><h3 id="errors-and-causes-3"><a href="#errors-and-causes-3" class="header-anchor">#</a> Errors and Causes</h3> <p>The following errors can be expected during authentication when connecting to PayFast.</p> <table><thead><tr><th>CODE</th> <th>ERROR MESSAGE</th> <th>REASON</th></tr></thead> <tbody><tr><td>400</td> <td>Required variables not present in request<br><br>Value for signature is not in the expected format<br><br>API version is not valid<br><br>Signature not present in headers</td> <td>The request is missing some or all of the required fields.<br><br>Generated when the merchant signature provided is not an MD5 hash, or is malformed.<br><br>Issued when the version header refers to a version that does not exist, or is malformed.<br><br>The signature has not been provided.</td></tr> <tr><td>401</td> <td>Merchant not found <br><br>Request origin not recognised<br><br>Request origin could not be verified<br><br>Merchant authorisation failed</td> <td>The given merchant ID was not found.<br><br>Generated when the request does not contain a REMOTE_ADDR value.<br><br>Occurs when the request is made from a location not specified in the whitelist.<br><br>The signature is incorrect.</td></tr> <tr><td>404</td> <td>Service / endpoint not found</td> <td>The endpoint does not exist or the requesting merchant does not have permission to access.</td></tr> <tr><td>429</td> <td>Signature rate limit reached, please try again in a few minutes</td> <td>The rate limit was hit.</td></tr> <tr><td>500</td> <td>Application Error<br><br>Communication Failure</td> <td>Application Error.<br><br>Networking issue with the API.</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/VuePress-Payfast-Docs/guide/" class="prev router-link-active">
        Web Integration
      </a></span> <span class="next"><a href="/VuePress-Payfast-Docs/guide/splitPayments.html">
        Split payments
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/VuePress-Payfast-Docs/assets/js/app.40217ecf.js" defer></script><script src="/VuePress-Payfast-Docs/assets/js/1.a320b6d4.js" defer></script><script src="/VuePress-Payfast-Docs/assets/js/11.8ec258f5.js" defer></script>
  </body>
</html>
